<xml xmlns="https://developers.google.com/blockly/xml"><block type="pxt-on-start" id="5N0Tf1/5tHlLkn)^Kubc" x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="1feF0a7uZFnvbQObd8#`" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="class Board {" line1="    public isKarelActive: boolean;" line2="    public karelX: number;" line3="    public karelY: number;" line4="" line5="    public ledState: Image;" line6="    private karelDirection: Direction;" line7="" line8="    constructor() {" line9="        this.isKarelActive = true;" line10="        this.karelX = 2;" line11="        this.karelY = 2;" line12="        this.karelDirection = Direction.UP;" line13="        this.ledState = images.createImage(`" line14="            . . . . ." line15="            . . . . ." line16="            . . . . ." line17="            . . . . ." line18="            . . . . ." line19="            `);" line20="    }" line21="" line22="    pressedA() {" line23="        if (!this.isKarelActive) {" line24="            return;" line25="        }" line26="        this.karelDirection = (this.karelDirection + 1) % 4;" line27="    }" line28="" line29="    pressedB() {" line30="        if (!this.isKarelActive) {" line31="            return;" line32="        }" line33="        this.ledState.setPixel(this.karelX, this.karelY, true);" line34="        this.moveKarel()" line35="    }" line36="" line37="    shake() {" line38="        if (!this.isKarelActive) {" line39="            return;" line40="        }" line41="        this.moveKarel()" line42="    }" line43="" line44="    private moveKarel() {" line45="        if (!this.isKarelActive) {" line46="            return;" line47="        }" line48="        switch (this.karelDirection) {" line49="            case Direction.UP:" line50="                if (this.karelY &gt; 0) {" line51="                    this.karelY -= 1;" line52="                }" line53="                break;" line54="            case Direction.LEFT:" line55="                if (this.karelX &gt; 0) {" line56="                    this.karelX -= 1;" line57="                }" line58="                break;" line59="            case Direction.DOWN:" line60="                if (this.karelY &lt; 4) {" line61="                    this.karelY += 1;" line62="                }" line63="                break;" line64="            case Direction.RIGHT:" line65="                if (this.karelX &lt; 4) {" line66="                    this.karelX += 1;" line67="                }" line68="                break;" line69="        }" line70="    }" line71="" line72="    pressedAB() {" line73="        this.isKarelActive = !this.isKarelActive;" line74="    }" line75="" line76="    update() {" line77="        this.ledState.showImage(0);" line78="    }" line79="}" numlines="80"></mutation><next><block type="typescript_statement" id="F~E5Gh}h4ea;~:2O=@[X" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const board = new Board();" numlines="1" declaredvars="board"></mutation><next><block type="typescript_statement" id="7mFWp%G+1^qXR[ALo/+i" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum Direction {" line1="    UP = 0," line2="    LEFT," line3="    DOWN," line4="    RIGHT" line5="}" numlines="6"></mutation></block></next></block></next></block></statement></block><block type="device_button_event" id="8JRa^c4u7|wRXYW6)a`d" x="0" y="3629"><field name="NAME">Button.B</field><statement name="HANDLER"><block type="typescript_statement" id="3oSIe2PWZ3~8^8uNDc`(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedB();" numlines="1"></mutation><next><block type="typescript_statement" id="p2#i-WRb:m/@qLA5^St^" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_gesture_event" id="*Ouc*vgtNG:Lif-bZ^4%" x="279" y="3629"><field name="NAME">Gesture.Shake</field><statement name="HANDLER"><block type="typescript_statement" id="#1pTPlm@8z~dnp%H@NS[" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.shake();" numlines="1"></mutation><next><block type="typescript_statement" id="iBMY1DMz}ewF+fFS@o#Y" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_button_event" id="|,iw:Km4Fe4iAKUJ5a,}" x="540" y="3629"><field name="NAME">Button.A</field><statement name="HANDLER"><block type="typescript_statement" id="V.%mwXlo(uJ.Jv,!b!Xf" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedA();" numlines="1"></mutation><next><block type="typescript_statement" id="#e#OvoY~t^Z:s!Yx~CdU" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_button_event" id=";W7MmlAC`=:A`y)h24_a" x="0" y="3850"><field name="NAME">Button.AB</field><statement name="HANDLER"><block type="typescript_statement" id="wQu;EWV4,bXE/ZH|^,@[" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.pressedAB();" numlines="1"></mutation><next><block type="typescript_statement" id="(E$0=R3~@Il6b9SQ3kAb" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="board.update();" numlines="1"></mutation></block></next></block></statement></block><block type="device_forever" id="=Tt}QiAjfyUcaDP8vWyu" x="287" y="3850"><statement name="HANDLER"><block type="controls_if" id="9q7I)OD8ay:HT~7NR9()"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="typescript_expression" id="1~+|7`g9p@vXseGtb@_3" editable="false"><field name="EXPRESSION">board.isKarelActive</field></block></value><statement name="DO0"><block type="device_led_toggle" id="GDYz8WcQn,u`Ojf2D9wl"><value name="x"><shadow type="math_number_minmax"><mutation min="0" max="4"/><field name="SLIDER">0</field></shadow><block type="typescript_expression" id="ROUGrvjH;vRQJY_1qDil" editable="false"><field name="EXPRESSION">board.karelX</field></block></value><value name="y"><shadow type="math_number_minmax"><mutation min="0" max="4"/><field name="SLIDER">0</field></shadow><block type="typescript_expression" id="P.~iwgfccsUWH/Da4!.]" editable="false"><field name="EXPRESSION">board.karelY</field></block></value><next><block type="device_pause" id="Gl0A8`wv2k9:gNrh5erS"><value name="pause"><shadow type="timePicker" id="b!}J,Osu2jW$/maKFKhs"><field name="ms">500</field></shadow></value></block></next></block></statement></block></statement></block></xml>